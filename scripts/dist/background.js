!function(){var e={};Object.defineProperty(e,"__esModule",{value:!0}),e.Config=void 0;class t{constructor(){this.blockMode="blacklist",this.blacklist=[],this.whitelist=[],this.blockSeen=!0,this.blockTyping=!0}static keys(){const e=new t;return Object.getOwnPropertyNames(e)}}e.Config=t;var i={},n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function l(e){try{d(n.next(e))}catch(t){s(t)}}function r(e){try{d(n.throw(e))}catch(t){s(t)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,r)}d((n=n.apply(e,t||[])).next())}))};function o(){return n(this,void 0,void 0,(function*(){return yield browser.storage.local.get(e.Config.keys())}))}function s(e,t){return n(this,void 0,void 0,(function*(){const i=JSON.stringify(e);return t?yield browser.tabs.sendMessage(t,i):yield browser.runtime.sendMessage(i)}))}Object.defineProperty(i,"__esModule",{value:!0}),i.sendCfg=i.setCfg=i.getCfg=void 0,i.getCfg=o,i.setCfg=function(e){return n(this,void 0,void 0,(function*(){return yield browser.storage.local.set(e),yield o()}))},i.sendCfg=function(e,t){return n(this,void 0,void 0,(function*(){const i={cfg:e};return yield s(i,t)}))};var l=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function l(e){try{d(n.next(e))}catch(t){s(t)}}function r(e){try{d(n.throw(e))}catch(t){s(t)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,r)}d((n=n.apply(e,t||[])).next())}))};Object.defineProperty({},"__esModule",{value:!0});const r=[];browser.runtime.onInstalled.addListener(()=>{const t=new e.Config;browser.storage.local.set(t)}),browser.runtime.onConnect.addListener(e=>l(void 0,void 0,void 0,(function*(){var t,n,o,s,l,d;try{const f=yield(0,i.getCfg)();(null===(n=null===(t=e.sender)||void 0===t?void 0:t.tab)||void 0===n?void 0:n.id)&&(r.push(null===(s=null===(o=e.sender)||void 0===o?void 0:o.tab)||void 0===s?void 0:s.id),(0,i.sendCfg)(f,null===(d=null===(l=e.sender)||void 0===l?void 0:l.tab)||void 0===d?void 0:d.id))}catch(f){console.log("connect",f)}}))),browser.runtime.onMessage.addListener((e,t)=>l(void 0,void 0,void 0,(function*(){const t=JSON.parse(e);if(t.toggleBlockMode)(0,i.setCfg)({blockMode:t.toggleBlockMode}).then(e=>{(0,i.sendCfg)(e);for(let t of r)(0,i.sendCfg)(e,t)});else if(void 0!==t.toggleBlockSeen)(0,i.setCfg)({blockSeen:t.toggleBlockSeen}).then(e=>{(0,i.sendCfg)(e);for(let t of r)(0,i.sendCfg)(e,t)});else if(void 0!==t.toggleBlockTyping)(0,i.setCfg)({blockTyping:t.toggleBlockTyping}).then(e=>{(0,i.sendCfg)(e);for(let t of r)(0,i.sendCfg)(e,t)});else if(t.addToBlacklist){const e=yield(0,i.getCfg)();if(e.blacklist.includes(t.addToBlacklist))return;e.blacklist.push(t.addToBlacklist),(0,i.setCfg)({blacklist:e.blacklist}).then(e=>{(0,i.sendCfg)(e);for(let t of r)(0,i.sendCfg)(e,t)})}else if(t.addToWhitelist){const e=yield(0,i.getCfg)();if(e.whitelist.includes(t.addToWhitelist))return;e.whitelist.push(t.addToWhitelist),(0,i.setCfg)({whitelist:e.whitelist}).then(e=>{(0,i.sendCfg)(e);for(let t of r)(0,i.sendCfg)(e,t)})}else if(t.removeFromBlacklist){const e=yield(0,i.getCfg)(),n=e.blacklist.indexOf(t.removeFromBlacklist);if(n<0)return;e.blacklist.splice(n,1),(0,i.setCfg)({blacklist:e.blacklist}).then(e=>{(0,i.sendCfg)(e);for(let t of r)(0,i.sendCfg)(e,t)})}else if(t.removeFromWhitelist){const e=yield(0,i.getCfg)(),n=e.whitelist.indexOf(t.removeFromWhitelist);if(n<0)return;e.whitelist.splice(n,1),(0,i.setCfg)({whitelist:e.whitelist}).then(e=>{(0,i.sendCfg)(e);for(let t of r)(0,i.sendCfg)(e,t)})}})))}();